datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Blog {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  title     String
  content   String?
  isLongText Boolean @default(false)
  viewCount Int      @default(0)
  author    User?    @relation(fields: [authorId], references: [id])
  authorId  Int?
}

model Profile {
  id     Int     @id @default(autoincrement())
  user   User    @relation(fields: [userId], references: [id])
  userId Int     @unique
}

model User {
  id       Int      @id @default(autoincrement())
  email    String   @unique
  name     String?
  prevName String   @default("") // 曾用名
  blogs    Blog[]
  profile  Profile?
  videos   Video[]
}

model Image {
  id                  Int    @id @default(autoincrement())
  src                 String
  name                String
  previewImageVideoId Int // 预览图所属视频id
  previewVideo        Video  @relation("PreviewImgs", fields: [previewImageVideoId], references: [id])

  fengmianVideoId Int   @unique
  fengmianVideo   Video @relation("FemgmianImg", fields: [fengmianVideoId], references: [id]) // 一对一的       
}

model Video {
  id          Int      @id @default(autoincrement())
  vvId        String  @default("")// 视频的唯一id  
  code        String //编码 可能冲突
  // uuid    String  @unique  // 唯一编码 冗余
  actors      User[]
  fielPath    String
  size        String
  note        String   @default("") // 备注
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  // 0 -> 初始状态 , 1 图片导入失败
  status      Int      @default(0)
  fengmian    Image?   @relation("FemgmianImg")
  previewImgs Image[]  @relation("PreviewImgs")
}

generator client {
  provider = "prisma-client-js"
}

// map 模型 to db
// npx prisma migrate dev --name init 

// npx prisma generate
